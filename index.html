<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Steve Jobs Anecdotes</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
<style>
	.wrapper{
		width: 97%;
		margin:auto;		
		font-family: Roboto;
		font-size: 16px;
		display: none;
	}
	.content{
		padding: 10px;
	}
	.steve{
		font-weight: bolder;
	}
	.footer{	
		font-family: Open Sans;
		font-size: 14px;
		font-weight: bold;
		padding: 10px;
		display: flex;
		justify-content: space-between;
	}
	.read-next{
		position: fixed;
		bottom: 5%;
		right:5%;
	}
	.btn-primary{
		font-size: 15px;
	}
</style>
</head>
<body>
	<div class="wrapper" id="wrapper">
		<div class="header"></div>
		<div class="content"></div>
		<div class="footer">
			<div class="owner"></div>
			<div class="copyright"></div>
		</div>
	</div>
	<div class="read-next">
		<button type="button" class="btn btn-primary">Read Another</button>
	</div>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script>
		$(document).ready(function(){

			$.get('./sjobs_anecdotes.json', function(data){

				var year = new Date().getFullYear();
				$('.copyright').html("<a href='https://allaboutstevejobs.com/' target='_blank'>allaboutstevejobs.com</a>&nbsp;&copy;&nbsp;"+year)

				var anecdotes = data['anecdotes'];

				$('button').click(function(){
					randomAnecdote();
				});

				var spotlight = function(paragraph){
					return paragraph.replace(/(steve jobs)/gi, "<span class='steve'>Steve Jobs</span>").replace(/jobs/gi, "<span class='steve'>Jobs</span>");
				};

				var randomAnecdote = function(){

					$('#wrapper').hide();

					var randomIndex = Math.floor(Math.random() * anecdotes.length);
					var anecdote = anecdotes[randomIndex];
					var paragraph = anecdote['paragraph'];
					
					var content = "";
					for(var i = 0;i < paragraph.length;i++){
						content += "<p>"+spotlight(paragraph[i])+"</p>";
					}
					$('.content').html(content);

					var sourceText = anecdote['source']['text'];
					var sourceLink = anecdote['source']['link'];
					if(!sourceText) sourceText = "Anonymous";
					if(!sourceLink) sourceLink = "javascript:void(0);";
					
					var footer = '<a class="source" href="'+sourceLink+'">'+sourceText+'</a>';
					$('.owner').html(footer);

					$('#wrapper').fadeIn(350);
				};

				randomAnecdote();

			});

			var scrollTop = 0;
			$(window).scroll(function(){
				if($(this).scrollTop() > scrollTop){
					$(".read-next").fadeOut(350);
				}else{
					$(".read-next").fadeIn(350);
				}
				scrollTop = $(this).scrollTop();
			});
		});
	</script>
</body>
</html>